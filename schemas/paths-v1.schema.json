{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/role-context-manager/schemas/paths-v1.schema.json",
  "title": "Path Configuration Schema",
  "description": "JSON Schema for validating paths.json manifest files in role-context-manager. Defines structure, required fields, and security constraints for path configuration.",
  "type": "object",
  "properties": {
    "claude_dir_name": {
      "type": "string",
      "description": "Name of the Claude configuration directory. Must be a simple directory name without path separators or traversal sequences.",
      "pattern": "^[a-zA-Z0-9._-]+$",
      "default": ".claude",
      "minLength": 1,
      "maxLength": 255,
      "examples": [
        ".claude",
        "claude-config",
        ".ai-config",
        "ai_workspace"
      ],
      "not": {
        "anyOf": [
          {
            "pattern": "\\.\\.",
            "description": "Must not contain path traversal sequences (..)"
          },
          {
            "pattern": "/",
            "description": "Must not contain path separators (/)"
          },
          {
            "pattern": "\\\\",
            "description": "Must not contain Windows path separators (\\)"
          },
          {
            "pattern": "\\x00",
            "description": "Must not contain null bytes"
          }
        ]
      }
    },
    "role_guides_dir": {
      "type": "string",
      "description": "Name of the role guides directory within the Claude configuration directory. Must be a simple directory name without path separators or traversal sequences.",
      "pattern": "^[a-zA-Z0-9._-]+$",
      "default": "role-guides",
      "minLength": 1,
      "maxLength": 255,
      "examples": [
        "role-guides",
        "roles",
        "agent-roles",
        "contexts"
      ],
      "not": {
        "anyOf": [
          {
            "pattern": "\\.\\.",
            "description": "Must not contain path traversal sequences (..)"
          },
          {
            "pattern": "/",
            "description": "Must not contain path separators (/)"
          },
          {
            "pattern": "\\\\",
            "description": "Must not contain Windows path separators (\\)"
          },
          {
            "pattern": "\\x00",
            "description": "Must not contain null bytes"
          }
        ]
      }
    },
    "version": {
      "type": "string",
      "description": "Schema version identifier for future compatibility. Follows semantic versioning format (major.minor.patch).",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "examples": [
        "1.0.0",
        "1.0.0-alpha",
        "1.0.0-beta.1",
        "2.1.3"
      ]
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of this path configuration. Useful for documenting custom configurations or organizational standards.",
      "minLength": 1,
      "maxLength": 1000,
      "examples": [
        "Default path configuration for role-context-manager",
        "Custom configuration for enterprise deployment",
        "Development environment path settings"
      ]
    },
    "project_root": {
      "type": "string",
      "description": "Optional project root directory identifier. Must be a simple directory name without path separators or traversal sequences.",
      "pattern": "^[a-zA-Z0-9._-]+$",
      "minLength": 1,
      "maxLength": 255,
      "examples": [
        "project",
        "workspace",
        "src"
      ],
      "not": {
        "anyOf": [
          {
            "pattern": "\\.\\.",
            "description": "Must not contain path traversal sequences (..)"
          },
          {
            "pattern": "/",
            "description": "Must not contain path separators (/)"
          },
          {
            "pattern": "\\\\",
            "description": "Must not contain Windows path separators (\\)"
          },
          {
            "pattern": "\\x00",
            "description": "Must not contain null bytes"
          }
        ]
      }
    },
    "additional_config_dirs": {
      "type": "array",
      "description": "Optional array of additional configuration directory names to search for role guides. Each must be a simple directory name.",
      "items": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9._-]+$",
        "minLength": 1,
        "maxLength": 255,
        "not": {
          "anyOf": [
            {
              "pattern": "\\.\\.",
              "description": "Must not contain path traversal sequences (..)"
            },
            {
              "pattern": "/",
              "description": "Must not contain path separators (/)"
            },
            {
              "pattern": "\\\\",
              "description": "Must not contain Windows path separators (\\)"
            },
            {
              "pattern": "\\x00",
              "description": "Must not contain null bytes"
            }
          ]
        }
      },
      "uniqueItems": true,
      "maxItems": 10,
      "examples": [
        [".config", "configs"],
        ["templates", "presets"]
      ]
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "description": "Default configuration",
      "version": "1.0.0",
      "claude_dir_name": ".claude",
      "role_guides_dir": "role-guides"
    },
    {
      "description": "Custom enterprise configuration",
      "version": "1.0.0",
      "claude_dir_name": ".ai-config",
      "role_guides_dir": "agent-contexts",
      "additional_config_dirs": [".config", "templates"]
    },
    {
      "description": "Minimal configuration",
      "claude_dir_name": "claude-workspace"
    }
  ],
  "definitions": {
    "safe_directory_name": {
      "description": "A safe directory name that prevents path traversal and other security issues",
      "type": "string",
      "pattern": "^[a-zA-Z0-9._-]+$",
      "minLength": 1,
      "maxLength": 255,
      "not": {
        "anyOf": [
          {
            "pattern": "\\.\\."
          },
          {
            "pattern": "/"
          },
          {
            "pattern": "\\\\"
          },
          {
            "pattern": "\\x00"
          }
        ]
      }
    }
  },
  "$comment": "This schema ensures backward compatibility by making all fields optional. Existing configurations will continue to work with default values. Security constraints prevent path traversal attacks and other injection vulnerabilities."
}
